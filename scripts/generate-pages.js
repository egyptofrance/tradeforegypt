const { createClient } = require('@supabase/supabase-js');
const fs = require('fs');

const supabaseUrl = process.env.SUPABASE_URL || 'https://npnzcdugtqhqclfcgipb.supabase.co';
const supabaseKey = process.env.SUPABASE_SERVICE_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5wbnpjZHVndHFocWNsZmNnaXBiIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2MjM4MTUxNSwiZXhwIjoyMDc3OTU3NTE1fQ.-1MU8CIYLOoFL5Kj7tOF38tlXqOfSHYvE9uw3Xj5i0c';

const supabase = createClient(supabaseUrl, supabaseKey);

// Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ø§Ù„Ø³ØªØ©
const keywords = [
    { slug: 'agency', name: 'ØªÙˆÙƒÙŠÙ„', template: 'dealer' },
    { slug: 'maintenance', name: 'ØµÙŠØ§Ù†Ø©', template: 'maintenance' },
    { slug: 'warranty', name: 'Ø¶Ù…Ø§Ù†', template: 'warranty' },
    { slug: 'customer-service', name: 'Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡', template: 'customer-service' },
    { slug: 'hotline', name: 'Ø®Ø· Ø³Ø§Ø®Ù†', template: 'hotline' },
    { slug: 'numbers', name: 'Ø£Ø±Ù‚Ø§Ù…', template: 'numbers' }
];

// Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
const contentTemplates = {
    dealer: (brand, product, keyword) => `
# ØªÙˆÙƒÙŠÙ„ ${product.name} ${brand.name}

Ù‡Ù„ ØªØ¨Ø­Ø« Ø¹Ù† **ØªÙˆÙƒÙŠÙ„ ${brand.name} Ø§Ù„Ù…Ø¹ØªÙ…Ø¯** Ù„Ù€ ${product.name}ØŸ Ù†Ø­Ù† Ø§Ù„ÙˆÙƒÙŠÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠ Ù„Ù€ ${brand.name} ÙÙŠ Ù…ØµØ±.

## Ù„Ù…Ø§Ø°Ø§ Ø§Ù„ØªÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ØŸ

Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø±Ùƒ Ù„Ù„ØªÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ Ù„Ù€ ${brand.name}ØŒ ØªØ­ØµÙ„ Ø¹Ù„Ù‰:

- **Ø¶Ù…Ø§Ù† Ø£ØµÙ„ÙŠ** Ù…Ù† Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…ØµÙ†Ø¹Ø©
- **Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø£ØµÙ„ÙŠØ©** 100%
- **ÙÙ†ÙŠÙŠÙ† Ù…Ø¹ØªÙ…Ø¯ÙŠÙ†** ÙˆÙ…Ø¯Ø±Ø¨ÙŠÙ†
- **Ø®Ø¯Ù…Ø© Ù…Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¨ÙŠØ¹** Ø§Ù„Ù…ØªÙ…ÙŠØ²Ø©
- **Ø£Ø³Ø¹Ø§Ø± Ø±Ø³Ù…ÙŠØ©** Ø¨Ø¯ÙˆÙ† Ø²ÙŠØ§Ø¯Ø§Øª

## Ù…Ù†ØªØ¬Ø§Øª ${brand.name}

Ù†ÙˆÙØ± Ø¬Ù…ÙŠØ¹ Ù…Ù†ØªØ¬Ø§Øª ${brand.name} Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ ${product.name} Ø¨Ø£Ø­Ø¯Ø« Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª ÙˆØ§Ù„ØªÙ‚Ù†ÙŠØ§Øª.

### Ù…Ù…ÙŠØ²Ø§Øª ${product.name} ${brand.name}

- Ø¬ÙˆØ¯Ø© ØªØµÙ†ÙŠØ¹ Ø¹Ø§Ù„ÙŠØ©
- ØªÙ‚Ù†ÙŠØ§Øª Ø­Ø¯ÙŠØ«Ø©
- ÙƒÙØ§Ø¡Ø© ÙÙŠ Ø§Ù„Ø£Ø¯Ø§Ø¡
- Ø¶Ù…Ø§Ù† Ø´Ø§Ù…Ù„

## Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„

Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† ${product.name} ${brand.name} Ø£Ùˆ Ù„Ù…Ø¹Ø±ÙØ© Ø£Ù‚Ø±Ø¨ ÙØ±Ø¹:

- ğŸ“ **Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- ğŸ“ **Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:** ÙØ±ÙˆØ¹Ù†Ø§ Ù…Ù†ØªØ´Ø±Ø© ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª
- ğŸ• **Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„:** Ù…Ù† Ø§Ù„Ø³Ø¨Øª Ø¥Ù„Ù‰ Ø§Ù„Ø®Ù…ÙŠØ³ØŒ 9 ØµØ¨Ø§Ø­Ø§Ù‹ - 6 Ù…Ø³Ø§Ø¡Ù‹

## Ù„Ù…Ø§Ø°Ø§ ${brand.name}ØŸ

${brand.name} Ù…Ù† Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© Ø§Ù„Ø±Ø§Ø¦Ø¯Ø© Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ ÙÙŠ Ù…Ø¬Ø§Ù„ ${product.name}ØŒ ÙˆØªØªÙ…ÙŠØ² Ø¨Ù€:

- Ø³Ù…Ø¹Ø© Ø¹Ø§Ù„Ù…ÙŠØ© Ù…Ù…ØªØ§Ø²Ø©
- Ø§Ø¨ØªÙƒØ§Ø± Ù…Ø³ØªÙ…Ø±
- Ø¬ÙˆØ¯Ø© Ù„Ø§ ØªØ¶Ø§Ù‡Ù‰
- Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡ Ù…ØªÙ…ÙŠØ²Ø©

Ø§ØªØµÙ„ Ø¨Ù†Ø§ Ø§Ù„Ø¢Ù† Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ø¹Ø±ÙˆØ¶ ${product.name} ${brand.name}!
`,

    maintenance: (brand, product, keyword) => `
# ØµÙŠØ§Ù†Ø© ${product.name} ${brand.name}

Ù…Ø±ÙƒØ² ØµÙŠØ§Ù†Ø© ${brand.name} Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ Ù„Ù€ ${product.name}. Ø®Ø¯Ù…Ø© ØµÙŠØ§Ù†Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ø¨Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø£ØµÙ„ÙŠØ© ÙˆØ¶Ù…Ø§Ù† Ù…Ø¹ØªÙ…Ø¯.

## Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØµÙŠØ§Ù†Ø©

Ù†Ù‚Ø¯Ù… Ø®Ø¯Ù…Ø§Øª ØµÙŠØ§Ù†Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù€ ${product.name} ${brand.name}:

### Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠØ©
- ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¬Ù‡Ø§Ø²
- ØªÙ†Ø¸ÙŠÙ ÙˆØªØ´Ø­ÙŠÙ…
- Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ø¯Ø§Ø¡
- ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„

### Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„
- ØªØ´Ø®ÙŠØµ Ø¯Ù‚ÙŠÙ‚ Ù„Ù„Ù…Ø´ÙƒÙ„Ø©
- Ø¥ØµÙ„Ø§Ø­ Ø³Ø±ÙŠØ¹ ÙˆÙØ¹Ø§Ù„
- Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø£ØµÙ„ÙŠØ© 100%
- Ø¶Ù…Ø§Ù† Ø¹Ù„Ù‰ Ø§Ù„Ø¥ØµÙ„Ø§Ø­

### Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„ÙˆÙ‚Ø§Ø¦ÙŠØ©
- Ù…Ù†Ø¹ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ù‚Ø¨Ù„ Ø­Ø¯ÙˆØ«Ù‡Ø§
- Ø¥Ø·Ø§Ù„Ø© Ø¹Ù…Ø± Ø§Ù„Ø¬Ù‡Ø§Ø²
- Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙØ§Ø¡Ø©

## Ù„Ù…Ø§Ø°Ø§ Ù…Ø±ÙƒØ² Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ØŸ

- âœ… ÙÙ†ÙŠÙˆÙ† Ù…Ø¹ØªÙ…Ø¯ÙˆÙ† Ù…Ù† ${brand.name}
- âœ… Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø£ØµÙ„ÙŠØ©
- âœ… Ø¶Ù…Ø§Ù† Ø¹Ù„Ù‰ Ø§Ù„ØµÙŠØ§Ù†Ø©
- âœ… Ø£Ø³Ø¹Ø§Ø± Ø±Ø³Ù…ÙŠØ©
- âœ… Ø®Ø¯Ù…Ø© Ù…Ù†Ø²Ù„ÙŠØ© Ù…ØªØ§Ø­Ø©

## Ø§ØªØµÙ„ Ø¨Ù†Ø§

Ù„Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ ØµÙŠØ§Ù†Ø© ${product.name} ${brand.name}:

- ğŸ“ **Ø±Ù‚Ù… Ø§Ù„ØµÙŠØ§Ù†Ø©:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- ğŸ  **Ø®Ø¯Ù…Ø© Ù…Ù†Ø²Ù„ÙŠØ©:** Ù…ØªÙˆÙØ±Ø© ÙÙŠ Ù…Ø¹Ø¸Ù… Ø§Ù„Ù…Ù†Ø§Ø·Ù‚
- âš¡ **Ø®Ø¯Ù…Ø© Ø·ÙˆØ§Ø±Ø¦:** Ù…ØªØ§Ø­Ø© Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©

## Ù†ØµØ§Ø¦Ø­ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ ${product.name}

- Ø§ØªØ¨Ø¹ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
- Ù‚Ù… Ø¨Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ø¯ÙˆØ±ÙŠØ©
- Ø§Ø³ØªØ®Ø¯Ù… Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø£ØµÙ„ÙŠØ© ÙÙ‚Ø·
- Ø§ØªØµÙ„ Ø¨Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ Ø¹Ù†Ø¯ Ø£ÙŠ Ù…Ø´ÙƒÙ„Ø©

Ø§Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ø§Ù„ØµÙŠØ§Ù†Ø© Ø§Ù„Ø¢Ù† ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø®ØµÙ… Ø®Ø§Øµ!
`,

    warranty: (brand, product, keyword) => `
# Ø¶Ù…Ø§Ù† ${product.name} ${brand.name}

Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø§Ù…Ù„Ø© Ø¹Ù† Ø¶Ù…Ø§Ù† ${product.name} ${brand.name} ÙÙŠ Ù…ØµØ±. ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬ Ù…Ø¹Ø±ÙØªÙ‡ Ø¹Ù† Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù…Ø¹ØªÙ…Ø¯.

## Ø´Ø±ÙˆØ· Ø§Ù„Ø¶Ù…Ø§Ù†

### Ù…Ø¯Ø© Ø§Ù„Ø¶Ù…Ø§Ù†
- Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬
- Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªÙ…Ø¯ÙŠØ¯ Ø§Ù„Ø¶Ù…Ø§Ù†
- Ø¶Ù…Ø§Ù† Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±

### Ù…Ø§ ÙŠØºØ·ÙŠÙ‡ Ø§Ù„Ø¶Ù…Ø§Ù†

ÙŠØºØ·ÙŠ Ø¶Ù…Ø§Ù† ${brand.name} Ù„Ù€ ${product.name}:

- Ø¹ÙŠÙˆØ¨ Ø§Ù„ØªØµÙ†ÙŠØ¹
- Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„ÙÙ†ÙŠØ©
- Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø± Ø§Ù„Ø£ØµÙ„ÙŠØ©
- Ø§Ù„Ø¹Ù…Ø§Ù„Ø© ÙˆØ§Ù„ØµÙŠØ§Ù†Ø©

### Ù…Ø§ Ù„Ø§ ÙŠØºØ·ÙŠÙ‡ Ø§Ù„Ø¶Ù…Ø§Ù†

Ø§Ù„Ø¶Ù…Ø§Ù† Ù„Ø§ ÙŠØ´Ù…Ù„:

- Ø³ÙˆØ¡ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
- Ø§Ù„Ø­ÙˆØ§Ø¯Ø« ÙˆØ§Ù„ÙƒÙˆØ§Ø±Ø«
- Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª ØºÙŠØ± Ø§Ù„Ù…ØµØ±Ø­ Ø¨Ù‡Ø§
- Ø§Ù„ØµÙŠØ§Ù†Ø© Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø¹ØªÙ…Ø¯

## ÙƒÙŠÙÙŠØ© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¶Ù…Ø§Ù†

1. Ø§Ø­ØªÙØ¸ Ø¨ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø´Ø±Ø§Ø¡
2. Ø³Ø¬Ù„ Ø§Ù„Ù…Ù†ØªØ¬ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ ${brand.name}
3. Ø§Ø­ØªÙØ¸ Ø¨Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¶Ù…Ø§Ù†
4. Ø§ØªØ¨Ø¹ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

## Ø§Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ø§Ù„Ø¶Ù…Ø§Ù†

Ø¹Ù†Ø¯ Ø­Ø¯ÙˆØ« Ø¹Ø·Ù„ ÙÙŠ ${product.name} ${brand.name}:

1. Ø§ØªØµÙ„ Ø¨Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
2. Ø§Ø­Ø¶Ø± Ø§Ù„Ø¬Ù‡Ø§Ø² Ù…Ø¹ Ø§Ù„Ø¶Ù…Ø§Ù† ÙˆØ§Ù„ÙØ§ØªÙˆØ±Ø©
3. Ø³ÙŠØªÙ… Ø§Ù„ÙØ­Øµ ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­ Ù…Ø¬Ø§Ù†Ø§Ù‹
4. Ø§Ø³ØªÙ„Ù… Ø§Ù„Ø¬Ù‡Ø§Ø² Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­

## Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±

- ğŸ“ **Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- ğŸ“§ **Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- ğŸŒ **Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:** tradeforegypt.com

## Ù†ØµØ§Ø¦Ø­ Ù…Ù‡Ù…Ø©

- Ø§Ø­ØªÙØ¸ Ø¨Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙÙŠ Ù…ÙƒØ§Ù† Ø¢Ù…Ù†
- Ù„Ø§ ØªØ­Ø§ÙˆÙ„ Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø¨Ù†ÙØ³Ùƒ
- Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ ÙÙ‚Ø·
- Ø³Ø¬Ù„ Ø§Ù„Ù…Ù†ØªØ¬ ÙÙˆØ± Ø§Ù„Ø´Ø±Ø§Ø¡

Ø¶Ù…Ø§Ù† ${brand.name} Ø±Ø§Ø­Ø© Ø¨Ø§Ù„Ùƒ!
`,

    'customer-service': (brand, product, keyword) => `
# Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡ ${brand.name} - ${product.name}

ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡ ${brand.name} Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ ÙˆØ§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø­ÙˆÙ„ ${product.name}.

## ÙƒÙŠÙ Ù†Ø³Ø§Ø¹Ø¯ÙƒØŸ

ÙØ±ÙŠÙ‚ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ù„Ø¯ÙŠÙ†Ø§ Ø¬Ø§Ù‡Ø² Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ:

### Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
- Ù…ÙˆØ§ØµÙØ§Øª ${product.name}
- Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶
- Ø§Ù„ØªÙˆÙØ± ÙˆØ§Ù„ØªØ³Ù„ÙŠÙ…
- Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª

### Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ
- Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªØ´ØºÙŠÙ„
- Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù…Ø«Ù„
- Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­
- Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±

### Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
- ØªÙ‚Ø¯ÙŠÙ… Ø´ÙƒÙˆÙ‰
- Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰
- Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„ØªØ­Ø³ÙŠÙ†
- ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø©

### Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
- Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
- Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ØªØ³Ù„ÙŠÙ…
- Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ ÙˆØ§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„
- Ø§Ù„Ø¶Ù…Ø§Ù†

## Ø·Ø±Ù‚ Ø§Ù„ØªÙˆØ§ØµÙ„

### Ø§Ù„Ù‡Ø§ØªÙ
ğŸ“ **Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- Ù…ØªØ§Ø­ Ù…Ù† Ø§Ù„Ø³Ø¨Øª Ø¥Ù„Ù‰ Ø§Ù„Ø®Ù…ÙŠØ³
- Ù…Ù† 9 ØµØ¨Ø§Ø­Ø§Ù‹ Ø¥Ù„Ù‰ 6 Ù…Ø³Ø§Ø¡Ù‹

### Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
ğŸ“§ **Ø§Ù„Ø¨Ø±ÙŠØ¯:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- Ø§Ù„Ø±Ø¯ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©

### Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
ğŸ’¬ **Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©:** Ù…ØªØ§Ø­Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹
- Ø±Ø¯ ÙÙˆØ±ÙŠ Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ

## Ø§Ù„ØªØ²Ø§Ù…Ù†Ø§ ØªØ¬Ø§Ù‡Ùƒ

Ù†Ù„ØªØ²Ù… ÙÙŠ ${brand.name} Ø¨Ù€:

- âœ… Ø§Ù„Ø±Ø¯ Ø§Ù„Ø³Ø±ÙŠØ¹ Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§ØªÙƒ
- âœ… Ø­Ù„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø¨ÙƒÙØ§Ø¡Ø©
- âœ… Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø­ØªÙ‰ Ø§Ù„Ø­Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
- âœ… Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù…Ù„

## Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©

### ÙƒÙŠÙ Ø£Ø´ØªØ±ÙŠ ${product.name}ØŸ
Ø§ØªØµÙ„ Ø¨Ù†Ø§ Ø£Ùˆ Ø²Ø± Ø£Ù‚Ø±Ø¨ ÙØ±Ø¹

### Ù…Ø§ Ù‡ÙŠ Ù…Ø¯Ø© Ø§Ù„Ø¶Ù…Ø§Ù†ØŸ
Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù†ØªØ¬

### Ù‡Ù„ Ø§Ù„ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠØŸ
ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©

Ù†Ø­Ù† Ù‡Ù†Ø§ Ù„Ø®Ø¯Ù…ØªÙƒ!
`,

    hotline: (brand, product, keyword) => `
# Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù† ${brand.name} - ${product.name}

Ø±Ù‚Ù… Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù† Ù„Ù€ ${brand.name} Ù…ØªØ§Ø­ 24/7 Ù„Ø®Ø¯Ù…ØªÙƒ ÙÙŠÙ…Ø§ ÙŠØ®Øµ ${product.name}.

## Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†

ğŸ“ **Ø±Ù‚Ù… Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹

### Ù…ØªØ§Ø­ Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©

Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù† Ù…ØªØ§Ø­ 24 Ø³Ø§Ø¹Ø©ØŒ 7 Ø£ÙŠØ§Ù… ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ù„ØªÙ„Ù‚ÙŠ:

- ğŸš¨ **Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„Ø¹Ø§Ø¬Ù„Ø©**
- âš ï¸ **Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„Ø·Ø§Ø±Ø¦Ø©**
- â“ **Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©**
- ğŸ“¦ **Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª**

## Ù…ØªÙ‰ ØªØªØµÙ„ Ø¨Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†ØŸ

### Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦
- Ø¹Ø·Ù„ Ù…ÙØ§Ø¬Ø¦ ÙÙŠ ${product.name}
- Ù…Ø´ÙƒÙ„Ø© ØªØ­ØªØ§Ø¬ Ø­Ù„ ÙÙˆØ±ÙŠ
- Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ø§Ø¬Ù„

### Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
- Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶
- Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ØªØ³Ù„ÙŠÙ…

### Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ
- Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªØ´ØºÙŠÙ„
- Ø£Ø³Ø¦Ù„Ø© ÙÙ†ÙŠØ©
- Ø·Ù„Ø¨ ØµÙŠØ§Ù†Ø©

## Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†

- â° Ù…ØªØ§Ø­ 24/7
- ğŸ¯ Ø±Ø¯ Ø³Ø±ÙŠØ¹
- ğŸ‘¨â€ğŸ’¼ ÙØ±ÙŠÙ‚ Ù…Ø­ØªØ±Ù
- ğŸ”§ Ø­Ù„ÙˆÙ„ ÙÙˆØ±ÙŠØ©

## Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø§ØªØµØ§Ù„

1. Ø§ØªØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø§Ø®Ù†
2. Ø§Ø®ØªØ± Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
3. ØªØ­Ø¯Ø« Ù…Ø¹ Ø§Ù„Ù…Ø®ØªØµ
4. Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù„

## Ø®Ø¯Ù…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©

- Ø­Ø¬Ø² Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ØµÙŠØ§Ù†Ø©
- Ø·Ù„Ø¨ Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±
- Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ÙˆØ§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¶Ù…Ø§Ù†

## Ù†ØµØ§Ø¦Ø­ Ø¹Ù†Ø¯ Ø§Ù„Ø§ØªØµØ§Ù„

- Ø¬Ù‡Ø² Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬
- Ø§Ø°ÙƒØ± Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨ÙˆØ¶ÙˆØ­
- Ø§Ø­ØªÙØ¸ Ø¨Ø±Ù‚Ù… Ø§Ù„Ø¨Ù„Ø§Øº
- ØªØ§Ø¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨

${brand.name} - Ø®Ø¯Ù…Ø© Ø¹Ù„Ù‰ Ù…Ø¯Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø©!
`,

    numbers: (brand, product, keyword) => `
# Ø£Ø±Ù‚Ø§Ù… ${brand.name} - ${product.name}

Ø¬Ù…ÙŠØ¹ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ ${brand.name} ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯ Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† ${product.name}.

## Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø§ØªØµØ§Ù„

### Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
ğŸ“ **Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„Ø´Ø±Ø§Ø¡
- Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø¹Ø±ÙˆØ¶
- Ø­Ø¬Ø² Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª

### Ø§Ù„ØµÙŠØ§Ù†Ø©
ğŸ”§ **Ø±Ù‚Ù… Ø§Ù„ØµÙŠØ§Ù†Ø©:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- Ø­Ø¬Ø² Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ØµÙŠØ§Ù†Ø©
- Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„ÙÙ†ÙŠØ©
- Ø·Ù„Ø¨ Ù‚Ø·Ø¹ Ø§Ù„ØºÙŠØ§Ø±

### Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
ğŸ‘¥ **Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
- Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
- Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ

### Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†
ğŸš¨ **Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- Ù…ØªØ§Ø­ 24/7
- Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦
- Ø§Ù„Ø±Ø¯ Ø§Ù„Ø³Ø±ÙŠØ¹

### Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰
ğŸ“‹ **Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- ØªÙ‚Ø¯ÙŠÙ… Ø´ÙƒÙˆÙ‰
- Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰
- Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª

## Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„

- **Ø§Ù„Ø³Ø¨Øª - Ø§Ù„Ø®Ù…ÙŠØ³:** 9 ØµØ¨Ø§Ø­Ø§Ù‹ - 6 Ù…Ø³Ø§Ø¡Ù‹
- **Ø§Ù„Ø¬Ù…Ø¹Ø©:** Ù…ØºÙ„Ù‚
- **Ø§Ù„Ø®Ø· Ø§Ù„Ø³Ø§Ø®Ù†:** 24/7

## Ø·Ø±Ù‚ ØªÙˆØ§ØµÙ„ Ø£Ø®Ø±Ù‰

### Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
ğŸ“§ **Ø§Ù„Ø¨Ø±ÙŠØ¯:** Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹

### Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
ğŸŒ **Ø§Ù„Ù…ÙˆÙ‚Ø¹:** tradeforegypt.com

### ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ
- Facebook: Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- Instagram: Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹
- Twitter: Ù…ØªØ§Ø­ Ù‚Ø±ÙŠØ¨Ø§Ù‹

## Ø§Ù„ÙØ±ÙˆØ¹

Ù„Ø¯ÙŠÙ†Ø§ ÙØ±ÙˆØ¹ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª:
- Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©
- Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©
- Ø§Ù„Ø¬ÙŠØ²Ø©
- ÙˆØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª

## Ù†ØµØ§Ø¦Ø­ Ù„Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„ÙØ¹Ø§Ù„

- Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
- Ø¬Ù‡Ø² Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬
- Ø§Ø°ÙƒØ± Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ Ø¨ÙˆØ¶ÙˆØ­
- Ø§Ø­ØªÙØ¸ Ø¨Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹

${brand.name} - Ø¯Ø§Ø¦Ù…Ø§Ù‹ ÙÙŠ Ø®Ø¯Ù…ØªÙƒ!
`
};

// Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø©
function generateContent(brand, product, keyword) {
    const template = contentTemplates[keyword.template];
    if (!template) {
        throw new Error(`Template not found: ${keyword.template}`);
    }
    return template(brand, product, keyword);
}

// Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
function generateTitle(brand, product, keyword) {
    const altName = brand.alternative_names && brand.alternative_names.length > 1 
        ? brand.alternative_names[1] 
        : brand.name;
    return `${keyword.name} ${product.name} ${brand.name} | ${altName} - Trade for Egypt`;
}

// Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙˆØµÙ
function generateMetaDescription(brand, product, keyword) {
    const altNames = brand.alternative_names ? brand.alternative_names.join('ØŒ ') : brand.name;
    return `${keyword.name} ${product.name} ${brand.name} Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ ÙÙŠ Ù…ØµØ±. ${altNames}. Ø®Ø¯Ù…Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ©ØŒ Ù‚Ø·Ø¹ ØºÙŠØ§Ø± Ø£ØµÙ„ÙŠØ©ØŒ Ø¶Ù…Ø§Ù† Ù…Ø¹ØªÙ…Ø¯. Ø§ØªØµÙ„ Ø§Ù„Ø¢Ù†!`;
}

// Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ H1
function generateH1(brand, product, keyword) {
    return `${keyword.name} ${product.name} ${brand.name} Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ ÙÙŠ Ù…ØµØ±`;
}

// Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø³Ù„Ø§Ø¬
function generateSlug(brand, product, keyword) {
    return `${brand.slug}/${product.slug}/${keyword.slug}`;
}

// Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø©
async function generatePage(brand, product, keyword) {
    const slug = generateSlug(brand, product, keyword);
    const title = generateTitle(brand, product, keyword);
    const metaDescription = generateMetaDescription(brand, product, keyword);
    const h1 = generateH1(brand, product, keyword);
    const content = generateContent(brand, product, keyword);
    
    const pageData = {
        brand_id: brand.id,
        product_id: product.id,
        keyword: keyword.name,
        slug: slug,
        title: title,
        meta_description: metaDescription,
        h1: h1,
        content: content
    };
    
    return pageData;
}

// Ø¯Ø§Ù„Ø© ØªÙˆÙ„ÙŠØ¯ ØµÙØ­Ø§Øª Ù„Ø¹Ø§Ø¦Ù„Ø© ÙˆØ§Ø­Ø¯Ø©
async function generatePagesForFamily(familyId, dryRun = true) {
    console.log('='.repeat(80));
    console.log(`ØªÙˆÙ„ÙŠØ¯ ØµÙØ­Ø§Øª Ù„Ù„Ø¹Ø§Ø¦Ù„Ø© ${familyId}`);
    console.log('='.repeat(80));
    
    // 1. Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª ÙÙŠ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©
    const { data: brandFamilies, error: bfError } = await supabase
        .from('brand_families')
        .select('brand_id')
        .eq('family_id', familyId);
    
    if (bfError) throw bfError;
    
    const brandIds = brandFamilies.map(bf => bf.brand_id);
    
    const { data: brands, error: brandsError } = await supabase
        .from('brands')
        .select('*')
        .in('id', brandIds);
    
    if (brandsError) throw brandsError;
    
    console.log(`\nâœ… ØªÙ… Ø¬Ù„Ø¨ ${brands.length} Ù…Ø§Ø±ÙƒØ©`);
    
    // 2. Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©
    const { data: products, error: productsError } = await supabase
        .from('products')
        .select('*')
        .eq('family_id', familyId);
    
    if (productsError) throw productsError;
    
    console.log(`âœ… ØªÙ… Ø¬Ù„Ø¨ ${products.length} Ù…Ù†ØªØ¬`);
    
    // 3. Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©
    const expectedPages = brands.length * products.length * keywords.length;
    console.log(`ğŸ“Š Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©: ${expectedPages}\n`);
    
    if (dryRun) {
        console.log('ğŸ§ª ÙˆØ¶Ø¹ Ø§Ù„ØªØ¬Ø±Ø¨Ø© (Dry Run) - Ù„Ù† ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙØ­Ø§Øª\n');
    }
    
    // 4. ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØµÙØ­Ø§Øª
    const pages = [];
    let count = 0;
    
    for (const brand of brands) {
        for (const product of products) {
            for (const keyword of keywords) {
                const page = await generatePage(brand, product, keyword);
                pages.push(page);
                count++;
                
                if (count <= 5) {
                    console.log(`âœ… ${page.slug}`);
                    console.log(`   ${page.title}`);
                }
            }
        }
    }
    
    console.log(`\nğŸ“¦ ØªÙ… ØªÙˆÙ„ÙŠØ¯ ${pages.length} ØµÙØ­Ø©`);
    
    // 5. Ø­ÙØ¸ Ø§Ù„ØµÙØ­Ø§Øª (Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† dry run)
    if (!dryRun) {
        console.log('\nğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØµÙØ­Ø§Øª ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
        
        // Ø­Ø°Ù Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù„Ù„Ø¹Ø§Ø¦Ù„Ø©
        const productIds = products.map(p => p.id);
        const { error: deleteError } = await supabase
            .from('pages')
            .delete()
            .in('product_id', productIds);
        
        if (deleteError) {
            console.log('âš ï¸  ØªØ­Ø°ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø°Ù:', deleteError.message);
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        const { data: insertedPages, error: insertError } = await supabase
            .from('pages')
            .insert(pages)
            .select();
        
        if (insertError) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸:', insertError);
            throw insertError;
        }
        
        console.log(`âœ… ØªÙ… Ø­ÙØ¸ ${insertedPages.length} ØµÙØ­Ø©`);
    }
    
    return {
        brands: brands.length,
        products: products.length,
        keywords: keywords.length,
        pages: pages.length,
        samplePages: pages.slice(0, 10)
    };
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª
if (require.main === module) {
    const familyId = process.argv[2] || 20; // Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ù†Ø²Ù„ÙŠØ© Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
    const dryRun = process.argv[3] !== 'save';
    
    generatePagesForFamily(familyId, dryRun)
        .then(result => {
            console.log('\n' + '='.repeat(80));
            console.log('ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬');
            console.log('='.repeat(80));
            console.log(`Ø§Ù„Ù…Ø§Ø±ÙƒØ§Øª: ${result.brands}`);
            console.log(`Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª: ${result.products}`);
            console.log(`Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©: ${result.keywords}`);
            console.log(`Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙØ­Ø§Øª: ${result.pages}`);
            console.log('\nğŸ‰ Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªÙˆÙ„ÙŠØ¯!');
            process.exit(0);
        })
        .catch(error => {
            console.error('âŒ Ø®Ø·Ø£:', error);
            process.exit(1);
        });
}

module.exports = { generatePagesForFamily, generatePage };
